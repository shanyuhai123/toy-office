import{d as e,c as t,a as l,r as a,b as n,o,w as s,e as u,v as i,n as c,f as r,g as h}from"./vendor.f2a9198c.js";var v=e({name:"ExcelStatusBar",setup:()=>()=>t("div",{class:"excel-status-bar"},[t("span",{class:"current-coordinate"},[l("A1")]),t("input",{type:"text",class:"calc-function"},null)])});const d=()=>((e,t=1)=>Array.from({length:e-t}).map(((e,l)=>t+l)))(91,65).map((e=>String.fromCharCode(e))),f="#0E6409",p=60,x=30;var g=e({name:"ExcelCore",setup(){const e=n(null),l=n(0),r=n(0),h=n(null),v=n(null),g=n("你好"),m=n(((...e)=>{})),y=n(((...e)=>{})),w=n(-9999),b=n(-9999);return o((async()=>{const{width:t,height:n}=function(e){const t=a({width:0,height:0});if(e){const{clientWidth:l,clientHeight:a}=e;t.width=l,t.height=a}return t}(e.value);l.value=t,r.value=n})),s(v,(async e=>{await c(),(async(e,t)=>{if(!e)return;const l=d();e.strokeStyle="#DDDDDD";let a=0,n=0;for(e.font="20px serif",e.textBaseline="middle",e.textAlign="center";t.width>p*a;){const n=p*a;e.moveTo(n,0),e.lineTo(n,t.height),e.stroke(),e.fillText(l[a]||"UN",n+1.5*p,x/2,p),a++}for(;t.height>x*n;){const l=x*n;e.moveTo(0,l),e.lineTo(t.width,l),e.stroke(),e.fillText((n+1).toString(),p/2,l+1.5*x,p),n++}e.strokeStyle="#b2b2b2",e.beginPath(),e.moveTo(p-5,x-5),e.lineTo(p-5,7.5),e.lineTo(15,x-5),e.fillStyle="#b4b4b4",e.fill(),e.closePath()})(e,{width:l.value,height:r.value})})),s(h,(async e=>{await c();const{handleClick:t,handleDoubleClick:a,top:o,left:s}=((e,t)=>{const l=n(-9999),a=n(-9999);return{top:l,left:a,handleClick:l=>{const{offsetX:a,offsetY:n}=l,o=Math.floor(a/p),s=Math.floor(n/x);o&&s&&(e.clearRect(0,0,t.width,t.height),e.strokeStyle=f,e.lineWidth=2,e.strokeRect(p*o,x*s,p,x))},handleDoubleClick:e=>{const{offsetX:t,offsetY:n}=e,o=Math.floor(t/p),s=Math.floor(n/x);o&&s&&(l.value=x*s,a.value=p*o,console.log(l.value))}}})(e,{width:l.value,height:r.value});m.value=t,y.value=a,w.value=o.value,b.value=s.value})),()=>t("div",{class:"excel-core",ref:e},[t("canvas",{class:"content-layer",width:l.value,height:r.value,ref:e=>{v.value=e&&e.getContext("2d")}},null),t("canvas",{class:"event-layer",width:l.value,height:r.value,ref:e=>{h.value=e&&e.getContext("2d")},onClick:m.value,onDblclick:y.value},null),u(t("input",{class:"canvas-input",type:"text","onUpdate:modelValue":e=>g.value=e,style:{width:p+"px",height:x+"px",top:w.value+"px",left:b.value+"px"}},null),[[i,g.value]])])}}),m=e({name:"ExcelContainer",setup:()=>()=>t("div",{class:"excel-container"},[t(v,null,null),t(g,null,null)])});h(e({name:"App",setup(){const e=n("未命名"),l=r((()=>{const t=(l=e.value,Array.from(l).reduce(((e,t)=>(t.match(/[^\x00-\xff]/gi)?e+=2:e+=1,e)),0));var l;return 9.6*(t>10?t:10)+"px"}));return()=>t("div",{id:"toy-sheet"},[t("header",{class:"toy-sheet-header"},[u(t("input",{type:"text",class:"sheet-name","onUpdate:modelValue":t=>e.value=t,style:{width:l.value},placeholder:"请输入名称"},null),[[i,e.value]])]),t(m,null,null)])}})).mount("#app");
