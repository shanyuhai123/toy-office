import{d as e,c as t,a as l,r as a,w as n,o as s,b as o,n as i,e as r,f as u,g as c,v as h,h as v}from"./vendor.ab9d77e1.js";var f=e({name:"ExcelStatusBar",setup:()=>()=>t("div",{class:"excel-status-bar"},[t("span",{class:"current-coordinate"},[l("A1")]),t("input",{type:"text",class:"calc-function"},null)])});const d=()=>((e,t=1)=>Array.from({length:e-t}).map(((e,l)=>t+l)))(91,65).map((e=>String.fromCharCode(e))),p=e=>{const t=d(),l=Math.floor(e/t.length),a=e%t.length;return`${l?t[l-1]:""}${t[a]}`},x=e=>Number(e.replace("px","")),g="#0E6409",y=60,m=30;var w=e({name:"ExcelCore",setup(){const e=r(null),l=a({width:-99999,height:-99999}),u=r(null),c=r(null),h=r(null);s((async()=>{const{width:t,height:n}=function(e){const t=a({width:0,height:0});if(e){const{clientWidth:l,clientHeight:a}=e;t.width=l,t.height=a}return t}(e.value);l.width=t,l.height=n})),((e,t)=>{n(e,(async e=>{if(!e)return;await i(),e.strokeStyle="#DDDDDD";let l=0,a=0;for(e.font="20px serif",e.textBaseline="middle",e.textAlign="center";t.width>y*l;){const a=y*l;e.moveTo(a,0),e.lineTo(a,t.height),e.stroke(),e.fillText(p(l),a+1.5*y,m/2,y),l++}for(;t.height>m*a;){const l=m*a;e.moveTo(0,l),e.lineTo(t.width,l),e.stroke(),e.fillText((a+1).toString(),y/2,l+1.5*m,y),a++}e.strokeStyle="#b2b2b2",e.beginPath(),e.moveTo(y-5,m-5),e.lineTo(y-5,7.5),e.lineTo(15,m-5),e.fillStyle="#b4b4b4",e.fill(),e.closePath()}))})(c,l),((e,t)=>{function l(){const l=e.value;if(!l)return;const{top:a,left:n}=l.style;l.style.top="-99999px",l.style.left="-99999px",t.value&&(t.value.font="20px serif",t.value.fillStyle="#000",t.value.textBaseline="middle",t.value.textAlign="center",t.value.fillText(l.value,x(n)+y/2,x(a)+m/2,y),l.value="",console.log(l.value))}s((()=>{var t;null==(t=e.value)||t.addEventListener("blur",l)})),o((()=>{var t;null==(t=e.value)||t.removeEventListener("blur",l)}))})(h,c);const{handleCanvasClick:v}=((e,t)=>{const l=r(((...e)=>{}));return n(e,(async e=>{e&&(await i(),l.value=l=>{const{offsetX:a,offsetY:n}=l,s=Math.floor(a/y),o=Math.floor(n/m);s&&o&&(e.clearRect(0,0,t.width,t.height),e.strokeStyle=g,e.lineWidth=2,e.strokeRect(y*s,m*o,y,m))})})),{handleCanvasClick:l}})(u,l),{handleCanvasDoubleClick:f,top:d,left:w}=((e,t)=>{const l=r(((...e)=>{})),a=r(-9999),s=r(-9999);return n(e,(async e=>{await i(),l.value=e=>{const{offsetX:t,offsetY:l}=e,n=Math.floor(t/y),o=Math.floor(l/m);n&&o&&(a.value=m*o,s.value=y*n,console.log(a.value))}})),{top:a,left:s,handleCanvasDoubleClick:l}})(u);return()=>t("div",{class:"excel-core",ref:e},[t("canvas",{class:"content-layer",width:l.width,height:l.height,ref:e=>{c.value=e&&e.getContext("2d")}},null),t("canvas",{class:"event-layer",width:l.width,height:l.height,ref:e=>{u.value=e&&e.getContext("2d")},onClick:v.value,onDblclick:f.value},null),t("input",{class:"canvas-input",type:"text",style:{width:y+"px",height:m+"px",top:d.value+"px",left:w.value+"px"},ref:h},null)])}}),b=e({name:"ExcelContainer",setup:()=>()=>t("div",{class:"excel-container"},[t(f,null,null),t(w,null,null)])});v(e({name:"App",setup(){const e=r("未命名"),l=u((()=>{const t=(l=e.value,Array.from(l).reduce(((e,t)=>(t.match(/[^\x00-\xff]/gi)?e+=2:e+=1,e)),0));var l;return 9.6*(t>10?t:10)+"px"}));return()=>t("div",{id:"toy-sheet"},[t("header",{class:"toy-sheet-header"},[c(t("input",{type:"text",class:"sheet-name","onUpdate:modelValue":t=>e.value=t,style:{width:l.value},placeholder:"请输入名称"},null),[[h,e.value]])]),t(b,null,null)])}})).mount("#app");
