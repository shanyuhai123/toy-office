import{d as e,c as t,r as l,w as a,o as n,a as o,n as s,b as r,e as i,f as u,v as c,g as h}from"./vendor.e84224df.js";var v=e({name:"ExcelStatusBar",props:{currentCoordinate:{type:String,default:"A1"}},setup:e=>()=>t("div",{class:"excel-status-bar"},[t("span",{class:"current-coordinate"},[e.currentCoordinate]),t("input",{type:"text",class:"calc-function"},null)])});const d=()=>((e,t=1)=>Array.from({length:e-t}).map(((e,l)=>t+l)))(91,65).map((e=>String.fromCharCode(e))),f=e=>{const t=d(),l=Math.floor(e/t.length),a=e%t.length;return`${l?t[l-1]:""}${t[a]}`},p=e=>Number(e.replace("px","")),x="#0E6409",g=60,m=30;var y=e({name:"ExcelCore",emits:["coordinate"],setup(e,{emit:i}){const u=r(null),c=l({width:-99999,height:-99999}),h=r(null),v=r(null),d=r(null);n((async()=>{const{width:e,height:t}=function(e){const t=l({width:0,height:0});if(e){const{clientWidth:l,clientHeight:a}=e;t.width=l,t.height=a}return t}(u.value);c.width=e,c.height=t})),((e,t)=>{a(e,(async e=>{if(!e)return;await s(),e.strokeStyle="#DDDDDD";let l=0,a=0;for(e.font="20px serif",e.textBaseline="middle",e.textAlign="center";t.width>g*l;){const a=g*l;e.moveTo(a,0),e.lineTo(a,t.height),e.stroke(),e.fillText(f(l),a+1.5*g,m/2,g),l++}for(;t.height>m*a;){const l=m*a;e.moveTo(0,l),e.lineTo(t.width,l),e.stroke(),e.fillText((a+1).toString(),g/2,l+1.5*m,g),a++}e.strokeStyle="#b2b2b2",e.beginPath(),e.moveTo(g-5,m-5),e.lineTo(g-5,7.5),e.lineTo(15,m-5),e.fillStyle="#b4b4b4",e.fill(),e.closePath()}))})(v,c),((e,t)=>{function l(){const l=e.value;if(!l)return;const{top:a,left:n}=l.style;l.style.top="-99999px",l.style.left="-99999px",t.value&&(t.value.font="20px serif",t.value.fillStyle="#000",t.value.textBaseline="middle",t.value.textAlign="center",t.value.fillText(l.value,p(n)+g/2,p(a)+m/2,g),l.value="",console.log(l.value))}n((()=>{var t;null==(t=e.value)||t.addEventListener("blur",l)})),o((()=>{var t;null==(t=e.value)||t.removeEventListener("blur",l)}))})(d,v);const{handleCanvasClick:y}=((e,t,l)=>{const n=r(((...e)=>{}));return a(e,(async e=>{e&&(await s(),n.value=a=>{const{offsetX:n,offsetY:o}=a,s=Math.floor(n/g),r=Math.floor(o/m);s&&r&&(l("coordinate",f(s-1)+r),e.clearRect(0,0,t.width,t.height),e.strokeStyle=x,e.lineWidth=2,e.strokeRect(g*s,m*r,g,m))})})),{handleCanvasClick:n}})(h,c,i),{handleCanvasDoubleClick:C,top:w,left:b}=((e,t)=>{const l=r(((...e)=>{})),n=r(-9999),o=r(-9999);return a(e,(async e=>{await s(),l.value=e=>{const{offsetX:t,offsetY:l}=e,a=Math.floor(t/g),s=Math.floor(l/m);a&&s&&(n.value=m*s,o.value=g*a,console.log(n.value))}})),{top:n,left:o,handleCanvasDoubleClick:l}})(h);return()=>t("div",{class:"excel-core",ref:u},[t("canvas",{class:"content-layer",width:c.width,height:c.height,ref:e=>{v.value=e&&e.getContext("2d")}},null),t("canvas",{class:"event-layer",width:c.width,height:c.height,ref:e=>{h.value=e&&e.getContext("2d")},onClick:y.value,onDblclick:C.value},null),t("input",{class:"canvas-input",type:"text",style:{width:g+"px",height:m+"px",top:w.value+"px",left:b.value+"px"},ref:d},null)])}}),C=e({name:"ExcelContainer",setup(){const e=r("A1"),l=t=>{e.value=t};return()=>t("div",{class:"excel-container"},[t(v,{currentCoordinate:e.value},null),t(y,{onCoordinate:l},null)])}});h(e({name:"App",setup(){const e=r("未命名"),l=i((()=>{const t=(l=e.value,Array.from(l).reduce(((e,t)=>(t.match(/[^\x00-\xff]/gi)?e+=2:e+=1,e)),0));var l;return 9.6*(t>10?t:10)+"px"}));return()=>t("div",{id:"toy-sheet"},[t("header",{class:"toy-sheet-header"},[u(t("input",{type:"text",class:"sheet-name","onUpdate:modelValue":t=>e.value=t,style:{width:l.value},placeholder:"请输入名称"},null),[[c,e.value]])]),t(C,null,null)])}})).mount("#app");
